<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CoreSync | My Profile</title>
    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <!-- Inter Font + Material Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
        rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { inter: ['Inter', 'sans-serif'] },
                    colors: { primary: '#2b6cee' }
                }
            }
        };
    </script>
</head>

<body class="font-inter bg-[#f6f6f8] text-gray-900 dark:bg-[#101622] dark:text-gray-100 min-h-screen">

    <!-- Navigation Bar -->
    <nav
        class="sticky top-0 z-50 flex items-center justify-between px-6 py-4 bg-white/80 dark:bg-[#181f2e]/80 backdrop-blur border-b border-gray-200 dark:border-gray-700">
        <a href="/main_dashboard" class="flex items-center gap-2">
            <span class="text-2xl font-bold text-primary">CoreSync</span>
        </a>
        <div class="flex items-center gap-4">
            <a href="/main_dashboard"
                class="flex items-center gap-1 text-gray-600 dark:text-gray-300 hover:text-primary transition">
                <span class="material-symbols-outlined text-xl">home</span>
                <span class="hidden sm:inline">Dashboard</span>
            </a>
            <button id="themeToggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition"
                title="Toggle theme">
                <span class="material-symbols-outlined text-xl">dark_mode</span>
            </button>
            <button id="logoutBtn"
                class="flex items-center gap-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition">
                <span class="material-symbols-outlined text-lg">logout</span>
                Logout
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 py-8">
        <!-- Profile Card -->
        <div class="bg-white dark:bg-[#181f2e] rounded-2xl shadow-lg p-6 mb-8">
            <div class="flex flex-col sm:flex-row items-center gap-6">
                <!-- Profile Image -->
                <div class="relative">
                    <div id="profileImageContainer"
                        class="w-32 h-32 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden">
                        <img id="profileImage" src="" alt="Profile" class="w-full h-full object-cover hidden" />
                        <span id="profileInitial" class="text-4xl font-bold text-gray-400">?</span>
                    </div>
                    <button id="changePhotoBtn"
                        class="absolute bottom-0 right-0 p-2 bg-primary hover:bg-blue-600 text-white rounded-full shadow-lg transition"
                        title="Change photo">
                        <span class="material-symbols-outlined text-lg">photo_camera</span>
                    </button>
                    <input type="file" id="photoInput" accept="image/*" class="hidden" />
                </div>

                <!-- Profile Info -->
                <div class="flex-1 text-center sm:text-left">
                    <h1 id="displayName" class="text-2xl font-bold mb-1">Loading...</h1>
                    <p id="username" class="text-gray-500 dark:text-gray-400 mb-4">@username</p>
                    <button id="editProfileBtn"
                        class="inline-flex items-center gap-2 px-4 py-2 bg-primary hover:bg-blue-600 text-white rounded-lg transition">
                        <span class="material-symbols-outlined text-lg">edit</span>
                        Edit Profile
                    </button>
                </div>
            </div>

            <!-- Stats -->
            <div class="grid grid-cols-2 gap-4 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
                <div class="text-center">
                    <p class="text-sm text-gray-500 dark:text-gray-400">Height</p>
                    <p id="heightDisplay" class="text-xl font-semibold">-- cm</p>
                </div>
                <div class="text-center">
                    <p class="text-sm text-gray-500 dark:text-gray-400">Weight</p>
                    <p id="weightDisplay" class="text-xl font-semibold">-- kg</p>
                </div>
            </div>
        </div>

        <!-- Saved Workout History -->
        <div class="bg-white dark:bg-[#181f2e] rounded-2xl shadow-lg p-6">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary">bookmark</span>
                    Saved Workouts
                </h2>
                <span id="savedCount" class="text-sm text-gray-500 dark:text-gray-400">0 saved</span>
            </div>

            <div id="savedHistoryContainer" class="space-y-4">
                <!-- Saved workouts will be rendered here -->
                <p id="noSavedMessage" class="text-center text-gray-500 dark:text-gray-400 py-8">
                    No saved workouts yet. Save workouts from your history to see them here!
                </p>
            </div>
        </div>
    </main>

    <!-- Edit Profile Modal -->
    <div id="editModal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/50 backdrop-blur-sm">
        <div class="bg-white dark:bg-[#181f2e] rounded-2xl shadow-2xl w-full max-w-md mx-4 p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold">Edit Profile</h3>
                <button id="closeModalBtn" class="p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>

            <form id="editProfileForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-1">Display Name</label>
                    <input type="text" id="editDisplayName"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent"
                        placeholder="Your name" />
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Height (cm)</label>
                        <input type="number" id="editHeight"
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent"
                            placeholder="175" />
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Weight (kg)</label>
                        <input type="number" id="editWeight"
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent"
                            placeholder="70" />
                    </div>
                </div>
                <button type="submit"
                    class="w-full py-3 bg-primary hover:bg-blue-600 text-white font-semibold rounded-lg transition">
                    Save Changes
                </button>
            </form>
        </div>
    </div>

    <!-- Photo Lightbox -->
    <div id="photoLightbox" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/90"
        onclick="closePhotoLightbox()">
        <button class="absolute top-4 right-4 p-2 text-white hover:bg-white/20 rounded-full transition">
            <span class="material-symbols-outlined text-3xl">close</span>
        </button>
        <img id="lightboxImage" src="" alt="Progress Photo" class="max-w-[90vw] max-h-[90vh] object-contain"
            onclick="event.stopPropagation()" />
    </div>

    <script src="/static/scripts/profile.js"></script>
</body>

</html>